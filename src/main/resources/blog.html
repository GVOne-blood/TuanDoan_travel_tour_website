<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tin Tức & Sự Kiện - Tuấn Đoàn Tour</title>

  <!--====== Favicon Icon ======-->
  <link rel="shortcut icon" href="assets/images/logo/logo-8.png" type="image/png" />

  <!-- ===== All CSS files ===== -->
  <link rel="stylesheet" href="assets/css/bootstrap.min.css" />
  <link rel="stylesheet" href="assets/css/animate.css" />
  <link rel="stylesheet" href="assets/css/lineicons.css" />
  <link rel="stylesheet" href="assets/css/ud-styles.css" />

  <!-- Custom CSS for News Page -->
  <style>
    .ud-single-blog { transition: all 0.3s ease-in-out; }
    .ud-single-blog:hover { transform: translateY(-10px); box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1); }
    .ud-blog-image img { height: 250px; object-fit: cover; }
    .ud-blog-title { display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; text-overflow: ellipsis; min-height: 56px; }
    .ud-blog-desc { display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; text-overflow: ellipsis; min-height: 72px; }
  </style>
</head>

<body>
<!-- ====== Header Start ====== -->
<header class="ud-header">
  <div class="container">
    <div class="row">
      <div class="col-lg-12">
        <nav class="navbar navbar-expand-lg">
          <a class="navbar-brand" href="index.html">
            <img src="assets/images/logo/logo-5.png" alt="Logo" />
          </a>
          <button class="navbar-toggler">
            <span class="toggler-icon"> </span><span class="toggler-icon"> </span><span class="toggler-icon"> </span>
          </button>
          <div class="navbar-collapse">
            <ul id="nav" class="navbar-nav mx-auto">
              <li class="nav-item"><a href="index.html">Trang chủ</a></li>
              <li class="nav-item"><a href="pricing.html">Giá Tour</a></li>
              <li class="nav-item"><a href="blog.html" style="color: #3652E1;">Tin Tức</a></li>
              <li class="nav-item"><a href="index.html#team">Hướng dẫn viên</a></li>
              <li class="nav-item"><a href="index.html#contact">Liên hệ</a></li>
            </ul>
          </div>
          <div class="navbar-btn d-none d-sm-inline-block">
            <a href="login.html" class="ud-main-btn ud-login-btn">Đăng nhập</a>
            <a href="signup.html" class="ud-main-btn ud-login-btn">Đăng kí</a>
          </div>
        </nav>
      </div>
    </div>
  </div>
</header>
<!-- ====== Header End ====== -->

<!-- ====== Banner Start ====== -->
<section class="ud-page-banner">
  <div class="container">
    <div class="row">
      <div class="col-lg-12">
        <div class="ud-banner-content">
          <h1>Tin Tức Du Lịch</h1>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- ====== Banner End ====== -->

<!-- ====== Blog Start ====== -->
<section id="news-section" class="ud-blog-grids py-5">
  <div class="container">
    <div class="row" id="news-grid">
      <div class="col-12 text-center py-5">
        <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;" role="status">
          <span class="visually-hidden">Đang tải...</span>
        </div>
      </div>
    </div>
    <nav id="news-pagination-nav" class="mt-5" aria-label="News Pagination">
      <ul class="pagination justify-content-center"></ul>
    </nav>
  </div>
</section>
<!-- ====== Blog End ====== -->

<!-- ====== Footer Start ====== -->
<footer class="ud-footer wow fadeInUp" data-wow-delay=".15s">
  <div class="shape shape-1"><img src="assets/images/footer/shape-1.svg" alt="shape" /></div>
  <div class="shape shape-2"><img src="assets/images/footer/shape-2.svg" alt="shape" /></div>
  <div class="shape shape-3"><img src="assets/images/footer/shape-3.svg" alt="shape" /></div>
  <div class="ud-footer-widgets">
    <div class="container">
      <div class="row">
        <div class="col-xl-3 col-lg-4 col-md-6">
          <div class="ud-widget">
            <a href="index.html" class="ud-footer-logo"><img src="assets/images/logo/logo-5.png" alt="logo" /></a>
            <p class="ud-widget-desc">Khám phá Việt Nam qua những hành trình độc đáo, được thiết kế riêng cho bạn.</p>
          </div>
        </div>
        <div class="col-xl-2 col-lg-2 col-md-6 col-sm-6">
          <div class="ud-widget"><h5 class="ud-widget-title">Về Chúng Tôi</h5><ul class="ud-widget-links"><li><a href="#">Trang Chủ</a></li><li><a href="#">Giới Thiệu</a></li></ul></div>
        </div>
        <div class="col-xl-2 col-lg-3 col-md-6 col-sm-6">
          <div class="ud-widget"><h5 class="ud-widget-title">Dịch Vụ</h5><ul class="ud-widget-links"><li><a href="#">Tour Trọn Gói</a></li><li><a href="#">Tour Cá Nhân</a></li></ul></div>
        </div>
        <div class="col-xl-2 col-lg-3 col-md-6 col-sm-6">
          <div class="ud-widget"><h5 class="ud-widget-title">Điểm Đến</h5><ul class="ud-widget-links"><li><a href="#">Vịnh Hạ Long</a></li><li><a href="#">Phố Cổ Hội An</a></li></ul></div>
        </div>
      </div>
    </div>
  </div>
  <div class="ud-footer-bottom">
    <div class="container"><div class="row"><div class="col-md-8"></div><div class="col-md-4"><p class="ud-footer-bottom-right">Designed and Developed by doannt2004</p></div></div></div>
  </div>
</footer>
<!-- ====== Footer End ====== -->

<a href="javascript:void(0)" class="back-to-top"><i class="lni lni-chevron-up"></i></a>

<!-- ====== All Javascript Files ====== -->
<script src="assets/js/bootstrap.bundle.min.js"></script>
<script src="assets/js/wow.min.js"></script>
<script src="assets/js/main.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

<script>
  $(document).ready(function() {
    const NEWS_PER_PAGE = 9;

    function fetchNews(pageIndex) {
      const newsGrid = $('#news-grid');
      const paginationNav = $('#news-pagination-nav');

      newsGrid.html(`<div class="col-12 text-center py-5"><div class="spinner-border text-primary" style="width: 3rem; height: 3rem;" role="status"><span class="visually-hidden">Đang tải...</span></div></div>`);
      paginationNav.hide();

      $.ajax({
        url: 'http://localhost:8085/api/tintuc/getAllPage',
        type: 'GET',
        data: {
          pageSize: NEWS_PER_PAGE,
          pageIndex: pageIndex
        },
        success: function(response) {
          if (response && response.status === 200 && response.data && Array.isArray(response.data.content)) {
            const pageData = response.data;
            renderNews(pageData.content);
            renderPagination(pageData);
            paginationNav.show();
          } else {
            newsGrid.html('<div class="col-12 text-center py-5"><h3>Không có tin tức nào.</h3></div>');
          }
        },
        error: function() {
          newsGrid.html('<div class="col-12 text-center py-5"><h3 class="text-danger">Lỗi khi tải dữ liệu.</h3></div>');
        }
      });
    }

    function renderNews(articles) {
      const newsGrid = $('#news-grid');
      newsGrid.empty();

      if (!articles || articles.length === 0) {
        newsGrid.html('<div class="col-12 text-center py-5"><h3>Không có tin tức nào.</h3></div>');
        return;
      }

      articles.forEach(article => {
        // SỬA LẠI TÊN THUỘC TÍNH Ở ĐÂY (từ snake_case sang camelCase)
        const formattedDate = new Date(article.ngayDang).toLocaleDateString('vi-VN', {
          day: '2-digit', month: '2-digit', year: 'numeric'
        });

        const articleHtml = `
                    <div class="col-lg-4 col-md-6">
                      <div class="ud-single-blog wow fadeInUp" data-wow-delay=".1s">
                        <div class="ud-blog-image">
                          <a href="blog-details.html?id=${article.id}">
                            <img src="${article.hinhAnh || 'assets/images/blog/blog-01.jpg'}" alt="${article.tieuDe}" />
                          </a>
                        </div>
                        <div class="ud-blog-content">
                          <span class="ud-blog-date">${formattedDate}</span>
                          <h3 class="ud-blog-title">
                            <a href="news-details.html?id=${article.id}">
                              ${article.tieuDe}
                            </a>
                          </h3>
                          <p class="ud-blog-desc">
                            ${article.tomTat}
                          </p>
                        </div>
                      </div>
                    </div>
                `;
        newsGrid.append(articleHtml);
      });
    }

    function renderPagination(pageData) {
      const paginationUl = $('#news-pagination-nav .pagination');
      paginationUl.empty();

      if (pageData.totalPages <= 1) return;

      const currentPage = pageData.number;
      const totalPages = pageData.totalPages;

      paginationUl.append(`<li class="page-item ${pageData.first ? 'disabled' : ''}"><a class="page-link" href="#" data-page="${currentPage - 1}">«</a></li>`);
      for (let i = 0; i < totalPages; i++) {
        paginationUl.append(`<li class="page-item ${i === currentPage ? 'active' : ''}"><a class="page-link" href="#" data-page="${i}">${i + 1}</a></li>`);
      }
      paginationUl.append(`<li class="page-item ${pageData.last ? 'disabled' : ''}"><a class="page-link" href="#" data-page="${currentPage + 1}">»</a></li>`);
    }

    $('#news-pagination-nav').on('click', '.page-link', function(e) {
      e.preventDefault();
      const pageLink = $(this);
      if (pageLink.parent().hasClass('disabled') || pageLink.parent().hasClass('active')) return;

      const pageIndex = parseInt(pageLink.data('page'));
      fetchNews(pageIndex);

      $('html, body').animate({
        scrollTop: $("#news-section").offset().top - 100
      }, 300);
    });

    fetchNews(0);
  });
</script>
</body>

</html>